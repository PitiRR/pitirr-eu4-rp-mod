ULM_diplomacy = {
	slot = 1
	generic = no
	ai = yes
	potential = {
		tag = ULM
	}
	has_country_shield = yes


	ULM_hre_allies = {
		icon = mission_alliances
		required_missions = { }
		position = 1
		
		trigger = {
			calc_true_if = { # alejandro is god
				any_country = {
					is_part_of_hre = yes
					alliance_with = ROOT
				}
				amount = 2
			}
		}

		effect = {
			add_prestige = 20
			add_country_modifier = {
				name = "regional_diplomacy"
				duration = 9125 #25 years
			}
		}
	}
	
	ULM_imperial_guarantee = {
	icon = mission_monarch_in_throne_room
	required_missions = { ULM_hre_allies }
	position = 2
		
		trigger = {
            OR = {
                alliance_with = emperor
                emperor = {
                    owes_favors = { who = ULM value = 10 }
                    has_opinion = {
                        who = root
                        value = 120
                    }
                }
            }
		}

		effect = { # replace with event
			add_dip_power = 100
			add_prestige = 20
			add_imperial_influence = 25
			emperor = {
				add_splendor = 200
				create_guarantee = ROOT
			}
		}
	}

	ULM_swabians_and_the_swiss = {
		icon = mission_italian_condottiere
		required_missions = { ULM_imperial_guarantee }
		position = 4
		
		trigger = {
			army_size_percentage = 0.8
			calc_true_if = {
				amount = 1
				all_country = {
					is_enemy = ROOT
					OR = {
						primary_culture = swiss
						primary_culture = swabian
					}
				}
			}
		}

		effect = {
			add_prestige = 10
			# country_event = ULM_zael_event.1
		}
	}
	
	ULM_free_city_guard = {
		icon = mission_landsknecht_soldier
		required_missions = { ULM_swabians_and_the_swiss ULM_defensive_overhaul }
		position = 6
		
		trigger = {
			employed_advisor = {
				type = army_reformer
				tier = 5
			}
			army_professionalism = 0.2
			OR = { 
				calc_true_if = {
					amount = 1
					all_country = {
						alliance_with = ROOT
						has_opinion = {
							who = ROOT
							value = 150
						}
						army_professionalism = 0.4
						OR = {
							primary_culture = swiss
							primary_culture = swabian
						}
					}
				}
				calc_true_if = {
					all_country = {
						vassal_of = ROOT
						has_opinion = {
							who = ROOT
							value = 100
						}
						OR = {
							primary_culture = swiss
							primary_culture = swabian
						}
					}
				}
			}
		}
		
		effect = {
			add_mil_power = 300
			add_army_professionalism = 0.1
			# country_event = ULM_zael_event.2
		}
	}
}

ULM_imperial_misc_missions = {
	slot = 2
	generic = no
	ai = yes
	potential = {
		tag = ULM
	}
	has_country_shield = yes
	
	ULM_imperial_bankers = {
		icon = mission_high_income
		required_missions = { ULM_imperial_guarantee }
		position = 3
		
		trigger = {
			OR = {
				employed_advisor = {
					type = treasurer
					level = 2
				}
				employed_advisor = {
					type = master_of_mint
					level = 2
				}
				employed_advisor = {
					type = trader
					level = 2
				}
				employed_advisor = {
					type = statesman
					level = 2
				}
			}
			diplomatic_reputation = 4
			mercantilism = 15
			OR = {
				ROOT = {
					guaranteed_by = emperor
					NOT = { inflation = 4 }
					monthly_income = 4
				}
				ROOT = {
					NOT = { inflation = 2 }
					monthly_income = 8
				}
			}
		}
		
		effect = {
			# country_event = ULM_zael_event.3
			add_years_of_income = 3
			add_mercantilism = 10
			hidden_effect = {
				limit = { guaranteed_by = emperor }
				add_imperial_influence = 20
			}
		}
	}
	
	ULM_defensive_overhaul = {
		icon = mission_conquer_50_development
		required_missions = { ULM_swabians_and_the_swiss ULM_establish_milf }
		position = 5
		
		trigger = {
			has_reform = municipal_self_defense_reform
			OR = { 
				calc_true_if = {
					amount = 1
					all_country = {
						alliance_with = ROOT
						has_opinion = {
							who = ROOT
							value = 150
						}
						army_professionalism = 0.4
						OR = {
							primary_culture = swiss
							primary_culture = swabian
						}
					}
				}
				all_country = {
					vassal_of = ROOT
					has_opinion = {
						who = ROOT
						value = 100
					}
					OR = {
						primary_culture = swiss
						primary_culture = swabian
					}
				}
				all_country = {
					NOT = {
						OR = {
							primary_culture = swiss
							primary_cultre = swabian
						}
					}
				}
			}
            1872 = {
				OR = {
					has_building = fort_15th
					has_building = fort_16th
					has_building = fort_17th
					has_building = fort_18th
				}
            }
			treasury = 1000
		}
		
		effect = {
			treasury = -600
			1872 = {
				add_permanent_province_modifier = {
					name = ULM_defensive_overhaul
					duration = -1
				}
			}
			custom_tooltip = emp_mlo_fortify_alps_effects_tooltip
			hidden_effect = {
				1872 = {
					if = {
						limit = { has_building = fort_17th }
						remove_building = fort_17th
						add_building = fort_18th
					}
					else_if = {
						limit = { has_building = fort_16th }
						remove_building = fort_16th
						add_building = fort_17th
					}
					else_if = {
						limit = { has_building = fort_15th }
						remove_building = fort_15th
						add_building = fort_16th
					}
				}
			}
		}
	}
}

ULM_province_development = {
	slot = 3
	generic = no
	ai = yes
	potential = {
		tag = ULM
	}
	has_country_shield = yes
	
	ULM_a_free_city = {
		icon = mission_colonial
		required_missions = { }
		position = 1
		
		provinces_to_highlight = {
			province_id = 1872
		}
		
		trigger = {
			1872 = {
				num_of_times_improved = 3
				has_building = temple
			}
		}
		
		effect = {
			add_prestige = 10
			1872 = {
				add_permanent_province_modifier = {
					name = ULM_city_tier_one
				}
			}
		}
	}
	
	ULM_early_municipal_safeguards = {
		icon = mission_colonial
		required_missions = { ULM_a_free_city }
		position = 2
		
		trigger = {
			army_size_percentage = 1
			treasury = 100
		}
		
		effect = {
			add_treasury = -50
			1872 = {
				add_building = fort_15th
				add_permanent_province_modifier = {
					name = ULM_defensive_safeguards
					duration = -1
				}
			}
		}
	}
	
	ULM_hundred_year_plans = {
		icon = mission_colonial
		required_missions = { ULM_early_municipal_safeguards }
		position = 3
		
		provinces_to_highlight = {
			province_id = 1872
		}
		
		trigger = {
			1872 = {
				num_of_times_improved = 8
				has_building = temple
				OR = {
					has_building = marketplace
					has_building = barracks
				}
			}
		}
		
		effect = {
			change_government_reform_progress = 150
			1872 = {
				add_permanent_province_modifier = {
					name = ULM_city_tier_two
					duration = -1
				}
			}
		}
	}
	
	ULM_establish_milf = {
		icon = mission_ottoman_harem
		required_missions = { ULM_imperial_bankers ULM_hundred_year_plans ULM_scriveners }
		position = 4
		
		trigger = {
			1872 = {
				num_of_times_improved = 15
			}
			employed_advisor = {
				type = spymaster
				level = 3
			}
			has_reform = provincial_governments_reform #replace with unique M.I.L.F.s gov't form
		}
		
		effect = {
			add_years_of_income = 1
			change_government_reform_progress = 260
			add_splendor = 800
		}
	}
	
	ULM_expand_regional_infrastructure = {
		icon = mission_early_game_buildings
		required_missions = { ULM_establish_milf }
		position = 5
		
		trigger = {
			1872 = {
				num_of_times_improved = 25
				province_has_center_of_trade_of_level = 2
			}
		}
		
		effect = {
			add_years_of_income = 2
			1872 = {
				add_permanent_province_modifier = {
					name = ULM_city_tier_three
					duration = -1
				}
			}
		}
	}
	
	ULM_the_free_city_of_worlds_desire = {
		icon = mission_hanseatic_city
		required_missions = { ULM_expand_regional_infrastructure ULM_defensive_overhaul }
		position = 6
		
		trigger = {
			1872 = {
				development = 75
				is_prosperous = yes
				province_has_center_of_trade_of_level = 3
				NOT = {
					unrest = 1
				}
			}
		}
		
		effect = {
			add_splendor = 1600
			add_prestige = 100
			1872 = {
				add_permanent_province_modifier = {
					name = ulm_city_tier_4
					duration = -1
				}
			}
		}
	}
	
	ULM_omnipotent = {
		icon = mission_empire
		required_missions = { ULM_the_free_city_of_worlds_desire }
		position = 7
		
		trigger = {
			1872 = {
				development = 100
			}
			OR = {
				has_reform = seize_executive_power_reform
				has_reform = reinforce_republican_values_reform
				has_reform = federal_senate_reform
			}
		}
		
		effect = {
			add_adm_power = 300
			add_dip_power = 300
			add_mil_power = 300
			1872 = {
				add_permanent_province_modifier = {
					name = ulm_city_tier_5
					duration = -1
				}
			}
		}
	}
}

ULM_misc_tree = {
	slot = 4
	generic = no
	ai = yes
	potential = {
		tag = ULM
	}
	has_country_shield = yes
	
	ULM_scriveners = {
		icon = mission_scholar_officials
		required_missions = { ULM_minster }
		position = 3
		
		trigger = {
			innovativeness = 20
			employed_advisor = {
				type = natural_scientist
				level = 2
			}
		}
		
		effect = {
		
		}
	}
	
	ULM_religious_alliance = {
		icon = mission_assemble_an_army
		required_missions { ULM_establish_milf ULM_vanguard_of_the_league }
		position = 5
		
		trigger = {
			is_year = 1550
			ROOT = { religion_group = christian }
			any_ally = {
				is_defender_of_faith = yes
				has_opinion = {
					who = ROOT
					value = 150
				}
			}
		}
		
		effect = {
			add_stability = 1
			add_war_exhaustion = -4
			add_fervor = 100
			add_church_power = 200
			add_papal_influence 200
		}
	}
}

ULM_religion_missions = {
	slot = 5
	generic = no
	ai = yes
	potential = {
		tag = ULM
	}
	has_country_shield = yes

	ULM_church_compromises = {
		icon = mission_religious
		required_missions = { }
		position = 1
		
		trigger = {
			treasury = 100
			estate_loyalty = {
				estate = estate_church
				loyalty = 50
			}
			estate_influence = {
				estate = estate_church
				influence = 50
			}
		}
		
		effect = {
			add_prestige = 1
			# ROOT = { country_event = ULM_zael_event.4 } # spend money and give church crownland for papal influence, temp relations, and perm church influence down. Or don't and piss off pope/lose prestige/temperory clergy influence increase.
		}
	}
	
	ULM_establish_an_ulm_minster = {
		icon = mission_european_church
		required_missions = { ULM_church_compromises }
		position = 2
		
		provinces_to_highlight = {
			province_id = 1872
		}
		
		trigger = {
			current_age = age_of_reformation
			has_great_project = {
				type = ulm_minster_great_project
				tier = 2
			}
		}
		
		effect = {
			add_years_of_income = 1
			1872 = {
				add_permanent_province_modifier = {
					name = ulm_minster_established
					duration = -1
				}
			}
			# ROOT = { country_event = ULM_zael_event.5 }
		}
	}
	
	ULM_vanguard_of_the_league = {
		icon = mission_teutonic_knights
		required_missions = { ULM_establish_an_ulm_minster }
		position = 4
		
		trigger = {
			1872 = {
				fort_level = 5
			}
			OR = {
				in_league = protestant
				in_league = catholic
			}
		}
		
		effect = {
			add_prestige = 1
			# ROOT = { country_event = ULM_zael_event.6 }
		}
	}
	
	ULM_triumph_of_the_true_league = {
		icon = mission_luther_theses
		required_missions = { ULM_religious_alliance ULM_vanguard_of_the_league }
		position = 6
		
		trigger = {
			emperor = {
				religion = ROOT
			}
			OR = {
				hre_religion_locked = yes
				hre_religion_treaty = yes
			}
		}
		
		effect = {
			add_prestige = 1
			# ROOT = { country_event = ULM_zael_event.7 }
		}
	}
}