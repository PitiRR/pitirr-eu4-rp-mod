ULM_diplomacy = {
	slot = 1
	generic = no
	ai = yes
	potential = {
		tag = ULM
	}
	has_country_shield = yes


	ULM_hre_allies = {
		icon = mission_alliances.dds
		required_missions = { }
		position = 1
		
		trigger = {
			calc_true_if = { # alejandro = god
				any_countries = {
					is_part_of_hre = yes
					allied_to = ROOT
				}
				amount = 2
			}
		}

		effect = {
			add_prestige = 20
			add_country_modifier = {
				name = "regional_diplomacy"
				duration = 9125 #25 years
			}
		}
	}
	
	ULM_imperial_guarantee = {
	icon = mission_monarch_in_throne_room.dds
	required_missions = { ULM_hre_allies }
	position = 2
		
		trigger = {
			calc_true_if = { # alejandro = god
				amount = 1
				OR = {
					alliance_with = emperor
					emperor = {
						owes_favors = { who = ULM value = 10 }
						has_opinion = {
							who = root
							value = 120
						}
					}
				}
			}
		}

		effect = { # replace with event
			add_dip_power = 100
			add_prestige = 20
			add_imperial_influence = 25
			all_countries = {
				is_emperor = yes
				add_splendor = 200
				create_guarantee = ULM
			}
		}
	}

	ULM_swabians_and_the_swiss = {
		icon = mission_italian_condotierre.dds
		required_missions = { ULM_imperial_guarantee }
		position = 4
		
		trigger = {
			army_size_percentage = 0.8
			any_country = {
				rival = ROOT
				OR = {
					primary_culture = swiss
					primary_culture = swabian
				}
			}
		}

		effect = {
			ROOT = { country_event = ULM_zael_event.1 }
		}
	}
	
	ULM_free_city_guard = {
		icon = mission_lanshknecht_soldier.dds
		required_missions = { ULM_swabians_and_the_swiss ULM_defensive_overhaul }
		position = 6
		
		trigger = {
			army_tradition = 60
			army_professionalism = 20
			OR = { 
				calc_true_if = {
					amount = 1
					any_ally = {
						has_opinion = {
							who = ROOT
							value = 150
						}
						army_professionalism = 40
						OR = {
							primary_culture = swiss
							primary_culture = swabian
						}
					}
				}
				any_country = {
					vassal_of = ROOT
					has_opinion = {
						who = ROOT
						value = 100
					}
					OR = {
						primary_culture = swiss
						primary_culture = swabian
					}
				}
			}
		}
		
		effect = {
			add_mil_power = 300
			add_army_professionalism = 10
			ROOT = { country_event = ULM_zael_event.2 }
		}
	}
}

ULM_imperial_misc_missions = {
	slot = 2
	generic = no
	ai = yes
	potential = {
		tag = ULM
	}
	has_country_shield = yes
	
	ULM_imperial_bankers = {
		icon = mission_high_income.dds
		required_missions = { ULM_imperial_guarantee }
		position = 3
		
		trigger = {
			employed_advisor = {
				OR = {
					type = treasurer
					type = master_of_mint
					type = trader
					type = statesman
				}
				level = 2
			}
			diplomatic_reputation = 4
			mercantilism = 15
			OR = {
				ROOT = {
					guaranteed_by = emperor
					NOT = { inflation = 4 }
					monthly_income = 4
				}
				ROOT = {
					NOT = { inflation = 2 }
					monthly_income = 8
				}
			}
		}
		
		effect = {
			ROOT = { country_event = ULM_zael_event.3 }
			add_years_of_income = 3
			add_mercantilism = 10
			hidden_effect = {
				limit = { guaranteed_by = emperor }
				add_imperial_influence = 20
			}
		}
	}
	
	ULM_defensive_overhaul = {
		icon = mission_conquer_50_development.dds
		required_missions = { ULM_swabians_and_the_swiss ULM_establish_milf }
		position = 5
		
		trigger = {
			has_reform = municipal_self_defense_reform
			OR = { 
				any_ally = {
					primary_culture = swabian
					has_opinion = {
						who = ROOT
						value = 150
					}
					army_tradition = 70
				}
				any_ally = {
					primary_culture = swiss
					has_opinion = {
						who = ROOT
						value = 150
					}
					army_tradition = 70
				}
				any_country = {
					NOT = {
						OR = {
							primary_culture = swiss
							primary_cultre = swabian
						}
					}
				}
			}
            1872 = {
				OR = {
					has_building = fort_15th
					has_building = fort_16th
					has_building = fort_17th
					has_building = fort_18th
				}
            }
			treasury = 1000
		}
		
		effect = {
			treasury = -600
			1872 = {
				add_permanent_province_modifier = {
					name = ULM_defensive_overhaul
					duration = -1
				}
			}
			custom_tooltip = emp_mlo_fortify_alps_effects_tooltip
			hidden_effect = {
				1872 = {
					if = {
						limit = { has_building = fort_17th }
						remove_building = fort_17th
						add_building = fort_18th
					}
					else_if = {
						limit = { has_building = fort_16th }
						remove_building = fort_16th
						add_building = fort_17th
					}
					else_if = {
						limit = { has_building = fort_15th }
						remove_building = fort_15th
						add_building = fort_16th
					}
				}
			}
		}
	}
}

ULM_province_development = {
	slot = 3
	generic = no
	ai = yes
	potential = {
		tag = ULM
	}
	has_country_shield = yes
	
	ULM_a_free_city = {
		icon = mission_early_game_buildings.dds
		required_missions = { }
		position = 1
		
		provinces_to_highlight = {
			province_id = 1872
		}
		
		trigger = {
			1872 = {
				num_of_times_improved = 3
				has_building = temple
			}
		}
		
		effect = {
			add_prestige = 10
			1872 = {
				add_permanent_province_modifier = {
					name = ULM_basic_improvements
				}
			}
		}
	}
	
	ULM_early_municipal_safeguards = {
		icon = mission_colonial.dds
		required_missions = { ULM_a_free_city }
		position = 2
		
		trigger = {
			army_size_percentage = 1
			treasury = 100
		}
		
		effect = {
			treasury = -50
			1872 = {
				add_building = fort_15th
				add_permanent_province_modifier = {
					name = ULM_defensive_safeguards
				}
			}
		}
	}
	
	ULM_hundred_year_plans = {
		icon =
		required_missions = { ULM_early_municipal_safeguards }
		position = 3
		
		trigger = {
			1872 = {
				num_of_times_improved = 8
				has_building = temple
				has_building = marketplace
				has_building = barracks
		}
		
		effect = {
			change_government_reform_progress = 150
			
		}
	}
	
	ULM_establish_milf = {
		icon = 
		required_missions = { ULM_imperial_bankers ULM_hundred_year_plans ULM_scriveners }
		position = 4
		
		trigger = {
			employed_advisor = {
				type = spymaster
				level = 3
			}
			has_reform = provincial_governments_reform #replace with unique M.I.L.F.s gov't form
		}
		
		effect = {
			add_years_of_income = 1
			change_government_reform_progress = 260
			add_splendor = 800
		}
	}
	
	ULM_expand_regional_infrastructure = {
		icon =
		required_missions = { ULM_establish_milf }
		position = 5
		
		trigger = {
			1872 = {
				num_of_times_improved = 25
				province_has_center_of_trade_level = 2
			}
		}
		
		effect = {
			add_years_of_income = 2
			1872 = {
				add_permanent_province_modifier = {
					name = ulm_city_tier_3
					duration = -1
				}
			}
		}
	}
	
	ULM_the_free_city_of_worlds_desire = {
		icon = 
		required_missions = { ULM_expand_regional_infrastructure ULM_defensive_overhaul }
		position = 6
		
		trigger = {
			1872 = {
				development = 75
				is_prosperous = yes
				has_matching_religion = ROOT
				province_has_center_of_trade_level = 3
				NOT = {
					unrest = 1
				}
			}
		}
		
		effect = {
			add_splendor = 1600
			add_prestige = 100
			1872 = {
				add_permanent_province_modifier = {
					name = ulm_city_tier_4
					duration = -1
				}
			}
		}
	}
	
	ULM_omnipotent = {
		icon =
		required_missions = { ULM_the_free_city_of_worlds_desire }
		position = 7
		
		trigger = {
			1872 = {
				development = 100
			}
			OR = {
				has_reform = seize_executive_power_reform
				has_reform = reinforce_republican_values_reform
				has_reform = federal_senate_reform
			}
		
		effect = {
			add_adm_power = 300
			add_dip_power = 300
			add_mil_power = 300
			1872 = {
				add_permanent_province_modifier = {
					name = ulm_city_tier_5
					duration = -1
				}
			}
		}
	}
}

ULM_misc_tree = {
	slot = 3
	generic = no
	ai = yes
	potential = {
		tag = ULM
	}
	has_country_shield = yes
	
	ULM_scriveners = {
		icon = 
		required_missions = { ULM_minster }
		position = 3
		
		trigger = {
			innovativeness = 20
			employed_advisor = {
				type = natural_scientist
				level = 2
			}
		}
		
		effect = {
		
		}
	}
	
	ULM_religious_alliance = {
		icon = 
		required_missions { ULM_establish_milf ULM_vanguard_of_the_league }
		position = 5
		
		trigger = {
			is_year = 1550
			ROOT = { religion_group = christian }
			any_ally = {
				is_defender_of_faith = yes
				has_opinion = {
					who = ROOT
					value = 150
				}
			}
		}
		
		effect = {
			add_stability = 1
			add_war_exhaustion = -4
			add_fervor = 100
			add_church_power = 200
			add_papal_influence 200
		}
	}
}

ULM_religion_missions = {
	slot = 5
	generic = no
	ai = yes
	potential = {
		tag = ULM
	}
	has_country_shield = yes

	ULM_church_compromises = {
		icon = 
		required_missions = { }
		position = 1
		
		trigger = {
			
		}
		
		effect = {
			ROOT = { country_event = ULM_zael_event.4 }
		}
	}
	
	ULM_establish_an_ulm_minster = {
		icon = 
		required_missions = { ULM_church_compromises }
		position = 2
		
		provinces_to_highlight = {
			province_id = 1872
		}
		
		trigger = {
			current_age = age_of_reformation
			has_great_project = {
				type = ulm_minster
				tier = 2
			}
		}
		
		effect = {
			add_years_of_income = 1
			1872 = {
				add_permanent_province_modifier = {
					name = ulm_minster_established
					duration = -1
				}
			}
			ROOT = { country_event = ULM_zael_event.5 }
		}
	}
	
	ULM_vanguard_of_the_league = {
		icon = 
		required_missions = { ULM_establish_an_ulm_minster }
		position = 4
		
		trigger = {
			1872 = {
				fort_level = 5
			}
			OR = {
				in_league = protestant
				in_league = catholic
			}
		}
		
		effect = {
			ROOT = { country_event = ULM_zael_event.6 }
		}
	}
	
	ULM_triumph_of_the_true_league = {
		icon = 
		required_missions = { ULM_religious_alliance ULM_vanguard_of_the_league }
		position = 6
		
		trigger = {
			OR = {
				hre_religion_locked = yes
				hre_religion_treaty = yes
			}
			emperor = {
				religion = ROOT
			}
		}
		
		effect = {
			ROOT = { country_event = ULM_zael_event.7 }
		}
	}
}